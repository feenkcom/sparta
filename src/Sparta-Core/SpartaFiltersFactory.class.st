"
I am a filter factory.

I know recepies of the very common filter and simplify developers life. I am also a nice place to add new app-specific filters as extention methods.

I am not backend specific since I only rely on public abstract api. It is very convenient for filters factory, we implement custom filter once and get support of it on all backends.

For a moment I provide four instagram-like filters to show an idea.

Public API and Key Messages

- brannan: create brannan filter for provided source.
- grayscale: create grayscale filter for provided source.
- inkwell: create grayscale filter for provided source.
- nashville: create nashville filter for provided source

kitty := canvas bitmap fromFileNamed: 'images/cats/kitty.jpg'.
brannan := canvas filters brannan: kitty.
"
Class {
	#name : #SpartaFiltersFactory,
	#superclass : #SpartaAbstractBuilder,
	#category : #'Sparta-Core-Builders'
}

{ #category : #accessing }
SpartaFiltersFactory >> blur [
	<return: #TSpartaGaussianBlurFilter>
	
	^ self subclassResponsibility
]

{ #category : #filters }
SpartaFiltersFactory >> brannan: aSurface [
	|gradient extent vignetteCanvas sourceAfterCurves sourceBelow50 sourceAbove50
	arithmetic00 arithmetic10 arithmeticBlend overlayWithAlpha finalOverlay|
	extent := aSurface extent.
	
	gradient := canvas paint radialGradient
		stops: { 
			0.75 -> ((Color r: 169 g: 170 b: 152 range: 255) alpha: 0).
			1.0 -> (Color r: 138 g: 135 b: 116 range: 255) };
		innerCenter: extent / 2;
		outerRadius: extent max / 2.

	vignetteCanvas := canvas similar: extent.
	vignetteCanvas fill
		paint: gradient;
		path: (0@0 extent: extent);
		draw.
	
	sourceAfterCurves := canvas tableTransferFilter
		source: aSurface;
		disableRed: false;
		disableBlue: false;
		disableGreen: false;
		tableRed: #(0.1451 0.1451 0.1452 0.1452 0.1454 0.1456 0.1458 0.1461 0.1465 0.147 0.1476 0.1482 0.149 0.1498 0.1507 0.1518 0.1529 0.1542 0.1556 0.1571 0.1586 0.1604 0.1622 0.1641 0.1662 0.1683 0.1706 0.1729 0.1754 0.178 0.1807 0.1834 0.1863 0.1892 0.1923 0.1954 0.1985 0.2018 0.205 0.2084 0.2118 0.2143 0.2169 0.2195 0.2221 0.2247 0.2272 0.2298 0.2325 0.2351 0.2377 0.2404 0.243 0.2457 0.2485 0.2512 0.254 0.2569 0.2598 0.2627 0.2657 0.2688 0.2719 0.2751 0.2784 0.2823 0.2864 0.2904 0.2946 0.2989 0.3032 0.3076 0.3121 0.3167 0.3213 0.326 0.3308 0.3356 0.3405 0.3455 0.3505 0.3556 0.3608 0.3657 0.3708 0.3758 0.3809 0.3861 0.3913 0.3966 0.4019 0.4073 0.4127 0.4182 0.4238 0.4294 0.435 0.4408 0.4466 0.4525 0.4585 0.4645 0.4706 0.4773 0.4842 0.4911 0.4981 0.5052 0.5123 0.5196 0.5269 0.5342 0.5416 0.5491 0.5566 0.5641 0.5717 0.5792 0.5868 0.5945 0.6021 0.6097 0.6173 0.6249 0.6324 0.64 0.6475 0.6549 0.6615 0.6681 0.6746 0.6811 0.6876 0.694 0.7004 0.7068 0.7132 0.7195 0.7259 0.7322 0.7385 0.7448 0.7511 0.7574 0.7638 0.7701 0.7765 0.7835 0.7905 0.7975 0.8044 0.8113 0.8181 0.8248 0.8315 0.838 0.8444 0.8507 0.8568 0.8627 0.8679 0.8729 0.8777 0.8823 0.8867 0.8909 0.895 0.8989 0.9026 0.9061 0.9095 0.9128 0.9158 0.9188 0.9216 0.9244 0.9272 0.9298 0.9323 0.9347 0.937 0.9391 0.9412 0.9432 0.945 0.9468 0.9485 0.95 0.9515 0.9529 0.9542 0.9555 0.9566 0.9577 0.9587 0.9597 0.9605 0.9614 0.9621 0.9628 0.9635 0.9641 0.9647 0.9658 0.9668 0.9678 0.9688 0.9698 0.9707 0.9716 0.9725 0.9733 0.9742 0.975 0.9758 0.9765 0.9773 0.978 0.9787 0.9794 0.9801 0.9808 0.9814 0.982 0.9827 0.9833 0.9838 0.9844 0.985 0.9856 0.9861 0.9866 0.9872 0.9877 0.9882 0.9888 0.9893 0.9898 0.9903 0.9908 0.9913 0.9919 0.9924 0.9929 0.9934 0.994 0.9945 0.9951 0.9957 0.9962 0.9968 0.9974 0.998 0.9987 0.9993 1);
		tableGreen: #(0 0.0001 0.0005 0.0011 0.0019 0.003 0.0042 0.0056 0.0072 0.0089 0.0107 0.0127 0.0149 0.0171 0.0194 0.0219 0.0244 0.027 0.0297 0.0324 0.0352 0.038 0.0409 0.0438 0.0468 0.0497 0.0528 0.0558 0.0588 0.0619 0.065 0.068 0.0711 0.0742 0.0774 0.0805 0.0836 0.0867 0.0899 0.0931 0.0962 0.0994 0.1026 0.1059 0.1094 0.1129 0.1165 0.1201 0.1238 0.1275 0.1313 0.1351 0.139 0.143 0.147 0.151 0.1552 0.1594 0.1637 0.1681 0.1725 0.177 0.1816 0.1864 0.1912 0.1961 0.2017 0.2075 0.2134 0.2194 0.2256 0.2319 0.2383 0.2448 0.2515 0.2582 0.2651 0.2721 0.2792 0.2864 0.2937 0.3011 0.3086 0.3162 0.3239 0.3316 0.3395 0.3474 0.3555 0.3635 0.3717 0.3799 0.3882 0.3967 0.4052 0.4138 0.4224 0.431 0.4397 0.4484 0.4571 0.4658 0.4745 0.4832 0.4919 0.5006 0.5092 0.5178 0.5264 0.5349 0.5434 0.5518 0.5601 0.5683 0.5765 0.5841 0.5916 0.5991 0.6064 0.6136 0.6208 0.6278 0.6347 0.6416 0.6483 0.6549 0.6614 0.6678 0.6741 0.6802 0.6863 0.692 0.6976 0.7031 0.7084 0.7137 0.7188 0.7238 0.7287 0.7335 0.7383 0.7429 0.7474 0.7518 0.7562 0.7604 0.7646 0.7688 0.7728 0.7768 0.7807 0.7846 0.7884 0.7922 0.7964 0.8005 0.8047 0.8088 0.8128 0.8168 0.8208 0.8247 0.8286 0.8324 0.8362 0.84 0.8436 0.8473 0.8509 0.8544 0.8579 0.8613 0.8647 0.868 0.8713 0.8745 0.8778 0.881 0.8842 0.8873 0.8904 0.8934 0.8963 0.8991 0.9019 0.9046 0.9071 0.9097 0.9121 0.9144 0.9166 0.9188 0.9208 0.9228 0.9246 0.9263 0.9279 0.9294 0.9304 0.9312 0.9321 0.9328 0.9335 0.9342 0.9348 0.9354 0.9361 0.9367 0.9373 0.9386 0.9401 0.9416 0.9432 0.9449 0.9466 0.9484 0.9502 0.9521 0.954 0.9559 0.9579 0.9598 0.9618 0.9638 0.9658 0.9677 0.9696 0.9715 0.9734 0.9752 0.977 0.9787 0.9804 0.982 0.9835 0.9849 0.9862 0.9874 0.9884 0.9894 0.9902 0.9909 0.9914 0.9918 0.992 0.992 0.9918 0.9915 0.9909 0.9901 0.9891 0.9879 0.9864 0.9847 0.9827 0.9804);
		tableBlue: #(0.1373 0.1373 0.1376 0.138 0.1385 0.1392 0.14 0.1409 0.1419 0.1431 0.1443 0.1457 0.1471 0.1486 0.1501 0.1518 0.1535 0.1552 0.157 0.1589 0.1608 0.1627 0.1647 0.1667 0.1687 0.1707 0.1728 0.1748 0.1769 0.179 0.1811 0.1832 0.1853 0.1874 0.1895 0.1916 0.1936 0.1957 0.1978 0.1998 0.2019 0.2039 0.2058 0.2077 0.2096 0.2114 0.2133 0.2151 0.217 0.2188 0.2207 0.2225 0.2244 0.2264 0.2283 0.2303 0.2323 0.2344 0.2365 0.2387 0.241 0.2434 0.2458 0.2483 0.251 0.2548 0.2588 0.263 0.2672 0.2716 0.2762 0.2809 0.2857 0.2906 0.2956 0.3008 0.3061 0.3115 0.317 0.3225 0.3282 0.334 0.3399 0.3458 0.3518 0.3579 0.364 0.3702 0.3765 0.3821 0.3878 0.3935 0.3993 0.405 0.4107 0.4165 0.4223 0.428 0.4338 0.4396 0.4454 0.4511 0.4569 0.4627 0.4684 0.4742 0.4799 0.4856 0.4913 0.4969 0.5026 0.5082 0.5138 0.5193 0.5249 0.5303 0.5358 0.5412 0.5464 0.5516 0.5568 0.5619 0.567 0.572 0.577 0.5819 0.5867 0.5915 0.5963 0.601 0.6056 0.6102 0.6147 0.6191 0.6235 0.6278 0.632 0.6362 0.6402 0.6442 0.6482 0.652 0.6558 0.6595 0.6632 0.6667 0.6702 0.6736 0.6769 0.6802 0.6834 0.6865 0.6895 0.6924 0.6953 0.698 0.7003 0.7024 0.7045 0.7066 0.7087 0.7107 0.7127 0.7147 0.7167 0.7187 0.7207 0.7228 0.725 0.7271 0.7294 0.7326 0.7359 0.7393 0.7428 0.7464 0.75 0.7537 0.7575 0.7613 0.7651 0.769 0.7728 0.7767 0.7806 0.7845 0.7884 0.7923 0.7961 0.7992 0.8023 0.8053 0.8082 0.8112 0.8141 0.8169 0.8198 0.8226 0.8254 0.8281 0.8309 0.8336 0.8363 0.839 0.8417 0.8444 0.8471 0.8502 0.8533 0.8564 0.8596 0.8627 0.8658 0.8689 0.872 0.8751 0.8782 0.8813 0.8843 0.8873 0.8903 0.8932 0.8961 0.8989 0.9017 0.9045 0.9072 0.9098 0.9124 0.9149 0.9173 0.9196 0.9219 0.9241 0.9262 0.9282 0.9301 0.9319 0.9336 0.9352 0.9366 0.938 0.9392 0.9403 0.9412 0.942 0.9427 0.9432 0.9435 0.9437 0.9437 0.9436 0.9433 0.9428 0.9421 0.9412).
		
	sourceBelow50 := canvas tableTransferFilter
		source: sourceAfterCurves;
		disableRed: false;
		disableBlue: false;
		disableGreen: false;
		tableRed: #(0 0.0039 0.0078 0.0118 0.0157 0.0196 0.0235 0.0275 0.0314 0.0353 0.0392 0.0431 0.0471 0.051 0.0549 0.0588 0.0627 0.0667 0.0706 0.0745 0.0784 0.0824 0.0863 0.0902 0.0941 0.098 0.102 0.1059 0.1098 0.1137 0.1176 0.1216 0.1255 0.1294 0.1333 0.1373 0.1412 0.1451 0.149 0.1529 0.1569 0.1608 0.1647 0.1686 0.1725 0.1765 0.1804 0.1843 0.1882 0.1922 0.1961 0.2 0.2039 0.2078 0.2118 0.2157 0.2196 0.2235 0.2275 0.2314 0.2353 0.2392 0.2431 0.2471 0.251 0.2549 0.2588 0.2627 0.2667 0.2706 0.2745 0.2784 0.2824 0.2863 0.2902 0.2941 0.298 0.302 0.3059 0.3098 0.3137 0.3176 0.3216 0.3255 0.3294 0.3333 0.3373 0.3412 0.3451 0.349 0.3529 0.3569 0.3608 0.3647 0.3686 0.3725 0.3765 0.3804 0.3843 0.3882 0.3922 0.3961 0.4 0.4039 0.4078 0.4118 0.4157 0.4196 0.4235 0.4275 0.4314 0.4353 0.4392 0.4431 0.4471 0.451 0.4549 0.4588 0.4627 0.4667 0.4706 0.4745 0.4784 0.4824 0.4863 0.4902 0.4941 0.498 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0);
		tableGreen: #(0 0.0039 0.0078 0.0118 0.0157 0.0196 0.0235 0.0275 0.0314 0.0353 0.0392 0.0431 0.0471 0.051 0.0549 0.0588 0.0627 0.0667 0.0706 0.0745 0.0784 0.0824 0.0863 0.0902 0.0941 0.098 0.102 0.1059 0.1098 0.1137 0.1176 0.1216 0.1255 0.1294 0.1333 0.1373 0.1412 0.1451 0.149 0.1529 0.1569 0.1608 0.1647 0.1686 0.1725 0.1765 0.1804 0.1843 0.1882 0.1922 0.1961 0.2 0.2039 0.2078 0.2118 0.2157 0.2196 0.2235 0.2275 0.2314 0.2353 0.2392 0.2431 0.2471 0.251 0.2549 0.2588 0.2627 0.2667 0.2706 0.2745 0.2784 0.2824 0.2863 0.2902 0.2941 0.298 0.302 0.3059 0.3098 0.3137 0.3176 0.3216 0.3255 0.3294 0.3333 0.3373 0.3412 0.3451 0.349 0.3529 0.3569 0.3608 0.3647 0.3686 0.3725 0.3765 0.3804 0.3843 0.3882 0.3922 0.3961 0.4 0.4039 0.4078 0.4118 0.4157 0.4196 0.4235 0.4275 0.4314 0.4353 0.4392 0.4431 0.4471 0.451 0.4549 0.4588 0.4627 0.4667 0.4706 0.4745 0.4784 0.4824 0.4863 0.4902 0.4941 0.498 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0);
		tableBlue: #(0 0.0039 0.0078 0.0118 0.0157 0.0196 0.0235 0.0275 0.0314 0.0353 0.0392 0.0431 0.0471 0.051 0.0549 0.0588 0.0627 0.0667 0.0706 0.0745 0.0784 0.0824 0.0863 0.0902 0.0941 0.098 0.102 0.1059 0.1098 0.1137 0.1176 0.1216 0.1255 0.1294 0.1333 0.1373 0.1412 0.1451 0.149 0.1529 0.1569 0.1608 0.1647 0.1686 0.1725 0.1765 0.1804 0.1843 0.1882 0.1922 0.1961 0.2 0.2039 0.2078 0.2118 0.2157 0.2196 0.2235 0.2275 0.2314 0.2353 0.2392 0.2431 0.2471 0.251 0.2549 0.2588 0.2627 0.2667 0.2706 0.2745 0.2784 0.2824 0.2863 0.2902 0.2941 0.298 0.302 0.3059 0.3098 0.3137 0.3176 0.3216 0.3255 0.3294 0.3333 0.3373 0.3412 0.3451 0.349 0.3529 0.3569 0.3608 0.3647 0.3686 0.3725 0.3765 0.3804 0.3843 0.3882 0.3922 0.3961 0.4 0.4039 0.4078 0.4118 0.4157 0.4196 0.4235 0.4275 0.4314 0.4353 0.4392 0.4431 0.4471 0.451 0.4549 0.4588 0.4627 0.4667 0.4706 0.4745 0.4784 0.4824 0.4863 0.4902 0.4941 0.498 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0).
	
	sourceAbove50 := canvas tableTransferFilter
		source: sourceAfterCurves;
		disableRed: false;
		disableBlue: false;
		disableGreen: false;
		tableRed: #(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.502 0.5059 0.5098 0.5137 0.5176 0.5216 0.5255 0.5294 0.5333 0.5373 0.5412 0.5451 0.549 0.5529 0.5569 0.5608 0.5647 0.5686 0.5725 0.5765 0.5804 0.5843 0.5882 0.5922 0.5961 0.6 0.6039 0.6078 0.6118 0.6157 0.6196 0.6235 0.6275 0.6314 0.6353 0.6392 0.6431 0.6471 0.651 0.6549 0.6588 0.6627 0.6667 0.6706 0.6745 0.6784 0.6824 0.6863 0.6902 0.6941 0.698 0.702 0.7059 0.7098 0.7137 0.7176 0.7216 0.7255 0.7294 0.7333 0.7373 0.7412 0.7451 0.749 0.7529 0.7569 0.7608 0.7647 0.7686 0.7725 0.7765 0.7804 0.7843 0.7882 0.7922 0.7961 0.8 0.8039 0.8078 0.8118 0.8157 0.8196 0.8235 0.8275 0.8314 0.8353 0.8392 0.8431 0.8471 0.851 0.8549 0.8588 0.8627 0.8667 0.8706 0.8745 0.8784 0.8824 0.8863 0.8902 0.8941 0.898 0.902 0.9059 0.9098 0.9137 0.9176 0.9216 0.9255 0.9294 0.9333 0.9373 0.9412 0.9451 0.949 0.9529 0.9569 0.9608 0.9647 0.9686 0.9725 0.9765 0.9804 0.9843 0.9882 0.9922 0.9961 1);
		tableGreen: #(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.502 0.5059 0.5098 0.5137 0.5176 0.5216 0.5255 0.5294 0.5333 0.5373 0.5412 0.5451 0.549 0.5529 0.5569 0.5608 0.5647 0.5686 0.5725 0.5765 0.5804 0.5843 0.5882 0.5922 0.5961 0.6 0.6039 0.6078 0.6118 0.6157 0.6196 0.6235 0.6275 0.6314 0.6353 0.6392 0.6431 0.6471 0.651 0.6549 0.6588 0.6627 0.6667 0.6706 0.6745 0.6784 0.6824 0.6863 0.6902 0.6941 0.698 0.702 0.7059 0.7098 0.7137 0.7176 0.7216 0.7255 0.7294 0.7333 0.7373 0.7412 0.7451 0.749 0.7529 0.7569 0.7608 0.7647 0.7686 0.7725 0.7765 0.7804 0.7843 0.7882 0.7922 0.7961 0.8 0.8039 0.8078 0.8118 0.8157 0.8196 0.8235 0.8275 0.8314 0.8353 0.8392 0.8431 0.8471 0.851 0.8549 0.8588 0.8627 0.8667 0.8706 0.8745 0.8784 0.8824 0.8863 0.8902 0.8941 0.898 0.902 0.9059 0.9098 0.9137 0.9176 0.9216 0.9255 0.9294 0.9333 0.9373 0.9412 0.9451 0.949 0.9529 0.9569 0.9608 0.9647 0.9686 0.9725 0.9765 0.9804 0.9843 0.9882 0.9922 0.9961 1);
		tableBlue: #(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.502 0.5059 0.5098 0.5137 0.5176 0.5216 0.5255 0.5294 0.5333 0.5373 0.5412 0.5451 0.549 0.5529 0.5569 0.5608 0.5647 0.5686 0.5725 0.5765 0.5804 0.5843 0.5882 0.5922 0.5961 0.6 0.6039 0.6078 0.6118 0.6157 0.6196 0.6235 0.6275 0.6314 0.6353 0.6392 0.6431 0.6471 0.651 0.6549 0.6588 0.6627 0.6667 0.6706 0.6745 0.6784 0.6824 0.6863 0.6902 0.6941 0.698 0.702 0.7059 0.7098 0.7137 0.7176 0.7216 0.7255 0.7294 0.7333 0.7373 0.7412 0.7451 0.749 0.7529 0.7569 0.7608 0.7647 0.7686 0.7725 0.7765 0.7804 0.7843 0.7882 0.7922 0.7961 0.8 0.8039 0.8078 0.8118 0.8157 0.8196 0.8235 0.8275 0.8314 0.8353 0.8392 0.8431 0.8471 0.851 0.8549 0.8588 0.8627 0.8667 0.8706 0.8745 0.8784 0.8824 0.8863 0.8902 0.8941 0.898 0.902 0.9059 0.9098 0.9137 0.9176 0.9216 0.9255 0.9294 0.9333 0.9373 0.9412 0.9451 0.949 0.9529 0.9569 0.9608 0.9647 0.9686 0.9725 0.9765 0.9804 0.9843 0.9882 0.9922 0.9961 1).
		
	"compute the 'low' part, b<0.5 ==> c=2ab"
	arithmetic00 := canvas arithmeticCombineFilter
		source: sourceBelow50;
		secondSource: vignetteCanvas;
		coefficients: { 2 . 0 . 0 . 0 }.
		
	"compute the 'high' part, b>0.5 ==> c=1-2(1-a)(1-b)=-2ab+2a+2b-1"
	arithmetic10 := canvas arithmeticCombineFilter
		source: sourceAbove50;
		secondSource: vignetteCanvas;
		coefficients: { -2 . 2 . 2 . -1 }.

	"combine high and low"
	arithmeticBlend := canvas arithmeticCombineFilter
		source: arithmetic00;
		secondSource: arithmetic10;
		coefficients: { 0 . 1 . 1 . 0 }.

	"re-apply alpha of vignette on blended result"
	overlayWithAlpha := canvas compositeFilter
		in;
		source: vignetteCanvas;
		source: arithmeticBlend.
		
	finalOverlay := canvas compositeFilter
		atop;
		source: sourceAfterCurves;
		source: overlayWithAlpha.	

	^ canvas colorMatrixFilter
		source: finalOverlay;
		matrix: #(
			0.52756 0.42912 0.04332 0 0
			0.12756 0.82912 0.04332 0 0
			0.12756 0.42912 0.44332 0 0
			0 0 0 1 0)
]

{ #category : #filters }
SpartaFiltersFactory >> grayscale: aSurfaceOrFilter [

	^ canvas colorMatrixFilter
		source: aSurfaceOrFilter;
		matrix: #(
			0.25 0.75 0.00 0.00 0.00
			0.25 0.75 0.00 0.00 0.00
			0.25 0.75 0.00 0.00 0.00
			0.00 0.00 0.00 1.00 0.00)
]

{ #category : #filters }
SpartaFiltersFactory >> inkwell: aSurfaceOrFilter [
	|grayscale|
	grayscale := self grayscale: aSurfaceOrFilter.

	^ canvas tableTransferFilter
		source: grayscale;
		disableRed: false;
		disableBlue: false;
		disableGreen: false;
		tableRed: #(0 0 0 0 0 0.0001 0.0002 0.0004 0.0007 0.001 0.0014 0.002 0.0026 0.0034 0.0043 0.0054 0.0066 0.008 0.0095 0.0112 0.0132 0.0153 0.0176 0.0201 0.0228 0.0257 0.0289 0.0323 0.036 0.0398 0.044 0.0484 0.053 0.0579 0.0631 0.0685 0.0742 0.0802 0.0864 0.0929 0.0997 0.1068 0.1142 0.1219 0.1298 0.138 0.1465 0.1553 0.1644 0.1737 0.1834 0.1933 0.2035 0.2139 0.2247 0.2357 0.2469 0.2585 0.2703 0.2824 0.2897 0.297 0.3043 0.3117 0.3191 0.3264 0.3338 0.3412 0.3485 0.3559 0.3632 0.3706 0.3779 0.3852 0.3925 0.3998 0.4071 0.4143 0.4215 0.4287 0.4358 0.4429 0.45 0.4571 0.4641 0.4711 0.478 0.4849 0.4917 0.4985 0.5053 0.512 0.5186 0.5252 0.5318 0.5383 0.5447 0.5511 0.5574 0.5636 0.5698 0.576 0.582 0.588 0.594 0.5998 0.6056 0.6114 0.617 0.6226 0.6281 0.6336 0.6389 0.6442 0.6495 0.6546 0.6597 0.6647 0.6696 0.6744 0.6792 0.6839 0.6885 0.693 0.6975 0.7018 0.7061 0.7103 0.7144 0.7185 0.7225 0.7263 0.7301 0.7339 0.7375 0.7411 0.7446 0.748 0.7513 0.7546 0.7577 0.7608 0.7639 0.7668 0.7697 0.7724 0.7752 0.7778 0.7804 0.7828 0.7853 0.7876 0.7899 0.7921 0.7942 0.7963 0.7983 0.8002 0.8021 0.8039 0.8057 0.8073 0.809 0.8105 0.812 0.8135 0.8149 0.8162 0.8175 0.8188 0.82 0.8211 0.8222 0.8232 0.8243 0.8252 0.8262 0.8271 0.8279 0.8287 0.8295 0.8303 0.831 0.8318 0.8325 0.8331 0.8338 0.8344 0.835 0.8356 0.8362 0.8368 0.8374 0.838 0.8386 0.8392 0.8398 0.8404 0.841 0.8416 0.8423 0.8429 0.8436 0.8443 0.8451 0.8458 0.8466 0.8475 0.8484 0.8493 0.8503 0.8513 0.8523 0.8535 0.8546 0.8559 0.8572 0.8586 0.86 0.8616 0.8632 0.8649 0.8666 0.8685 0.8705 0.8725 0.8747 0.877 0.8793 0.8818 0.8844 0.8872 0.89 0.893 0.8961 0.8994 0.9027 0.9063 0.91 0.9138 0.9178 0.922 0.9263 0.9308 0.9355 0.9404 0.9454 0.9507 0.9561 0.9617 0.9676 0.9736 0.9799 0.9864 0.9931 1);
		tableGreen: #(0 0 0 0 0 0.0001 0.0002 0.0004 0.0007 0.001 0.0014 0.002 0.0026 0.0034 0.0043 0.0054 0.0066 0.008 0.0095 0.0112 0.0132 0.0153 0.0176 0.0201 0.0228 0.0257 0.0289 0.0323 0.036 0.0398 0.044 0.0484 0.053 0.0579 0.0631 0.0685 0.0742 0.0802 0.0864 0.0929 0.0997 0.1068 0.1142 0.1219 0.1298 0.138 0.1465 0.1553 0.1644 0.1737 0.1834 0.1933 0.2035 0.2139 0.2247 0.2357 0.2469 0.2585 0.2703 0.2824 0.2897 0.297 0.3043 0.3117 0.3191 0.3264 0.3338 0.3412 0.3485 0.3559 0.3632 0.3706 0.3779 0.3852 0.3925 0.3998 0.4071 0.4143 0.4215 0.4287 0.4358 0.4429 0.45 0.4571 0.4641 0.4711 0.478 0.4849 0.4917 0.4985 0.5053 0.512 0.5186 0.5252 0.5318 0.5383 0.5447 0.5511 0.5574 0.5636 0.5698 0.576 0.582 0.588 0.594 0.5998 0.6056 0.6114 0.617 0.6226 0.6281 0.6336 0.6389 0.6442 0.6495 0.6546 0.6597 0.6647 0.6696 0.6744 0.6792 0.6839 0.6885 0.693 0.6975 0.7018 0.7061 0.7103 0.7144 0.7185 0.7225 0.7263 0.7301 0.7339 0.7375 0.7411 0.7446 0.748 0.7513 0.7546 0.7577 0.7608 0.7639 0.7668 0.7697 0.7724 0.7752 0.7778 0.7804 0.7828 0.7853 0.7876 0.7899 0.7921 0.7942 0.7963 0.7983 0.8002 0.8021 0.8039 0.8057 0.8073 0.809 0.8105 0.812 0.8135 0.8149 0.8162 0.8175 0.8188 0.82 0.8211 0.8222 0.8232 0.8243 0.8252 0.8262 0.8271 0.8279 0.8287 0.8295 0.8303 0.831 0.8318 0.8325 0.8331 0.8338 0.8344 0.835 0.8356 0.8362 0.8368 0.8374 0.838 0.8386 0.8392 0.8398 0.8404 0.841 0.8416 0.8423 0.8429 0.8436 0.8443 0.8451 0.8458 0.8466 0.8475 0.8484 0.8493 0.8503 0.8513 0.8523 0.8535 0.8546 0.8559 0.8572 0.8586 0.86 0.8616 0.8632 0.8649 0.8666 0.8685 0.8705 0.8725 0.8747 0.877 0.8793 0.8818 0.8844 0.8872 0.89 0.893 0.8961 0.8994 0.9027 0.9063 0.91 0.9138 0.9178 0.922 0.9263 0.9308 0.9355 0.9404 0.9454 0.9507 0.9561 0.9617 0.9676 0.9736 0.9799 0.9864 0.9931 1);
		tableBlue: #(0 0 0 0 0 0.0001 0.0002 0.0004 0.0007 0.001 0.0014 0.002 0.0026 0.0034 0.0043 0.0054 0.0066 0.008 0.0095 0.0112 0.0132 0.0153 0.0176 0.0201 0.0228 0.0257 0.0289 0.0323 0.036 0.0398 0.044 0.0484 0.053 0.0579 0.0631 0.0685 0.0742 0.0802 0.0864 0.0929 0.0997 0.1068 0.1142 0.1219 0.1298 0.138 0.1465 0.1553 0.1644 0.1737 0.1834 0.1933 0.2035 0.2139 0.2247 0.2357 0.2469 0.2585 0.2703 0.2824 0.2897 0.297 0.3043 0.3117 0.3191 0.3264 0.3338 0.3412 0.3485 0.3559 0.3632 0.3706 0.3779 0.3852 0.3925 0.3998 0.4071 0.4143 0.4215 0.4287 0.4358 0.4429 0.45 0.4571 0.4641 0.4711 0.478 0.4849 0.4917 0.4985 0.5053 0.512 0.5186 0.5252 0.5318 0.5383 0.5447 0.5511 0.5574 0.5636 0.5698 0.576 0.582 0.588 0.594 0.5998 0.6056 0.6114 0.617 0.6226 0.6281 0.6336 0.6389 0.6442 0.6495 0.6546 0.6597 0.6647 0.6696 0.6744 0.6792 0.6839 0.6885 0.693 0.6975 0.7018 0.7061 0.7103 0.7144 0.7185 0.7225 0.7263 0.7301 0.7339 0.7375 0.7411 0.7446 0.748 0.7513 0.7546 0.7577 0.7608 0.7639 0.7668 0.7697 0.7724 0.7752 0.7778 0.7804 0.7828 0.7853 0.7876 0.7899 0.7921 0.7942 0.7963 0.7983 0.8002 0.8021 0.8039 0.8057 0.8073 0.809 0.8105 0.812 0.8135 0.8149 0.8162 0.8175 0.8188 0.82 0.8211 0.8222 0.8232 0.8243 0.8252 0.8262 0.8271 0.8279 0.8287 0.8295 0.8303 0.831 0.8318 0.8325 0.8331 0.8338 0.8344 0.835 0.8356 0.8362 0.8368 0.8374 0.838 0.8386 0.8392 0.8398 0.8404 0.841 0.8416 0.8423 0.8429 0.8436 0.8443 0.8451 0.8458 0.8466 0.8475 0.8484 0.8493 0.8503 0.8513 0.8523 0.8535 0.8546 0.8559 0.8572 0.8586 0.86 0.8616 0.8632 0.8649 0.8666 0.8685 0.8705 0.8725 0.8747 0.877 0.8793 0.8818 0.8844 0.8872 0.89 0.893 0.8961 0.8994 0.9027 0.9063 0.91 0.9138 0.9178 0.922 0.9263 0.9308 0.9355 0.9404 0.9454 0.9507 0.9561 0.9617 0.9676 0.9736 0.9799 0.9864 0.9931 1)
]

{ #category : #filters }
SpartaFiltersFactory >> nashville: aSurfaceOrFilter [
	^ canvas tableTransferFilter
		source: aSurfaceOrFilter;
		disableRed: false;
		disableBlue: false;
		disableGreen: false;
		tableRed: #(0 0.0002 0.0006 0.0013 0.0022 0.0033 0.0046 0.0061 0.0077 0.0094 0.0112 0.0131 0.0151 0.0171 0.0191 0.0212 0.0233 0.0253 0.0274 0.0294 0.0314 0.0333 0.0352 0.0371 0.0389 0.0407 0.0425 0.0441 0.0458 0.0474 0.0489 0.0504 0.0519 0.0534 0.0549 0.0569 0.0589 0.0608 0.0628 0.0647 0.0665 0.0683 0.07 0.0716 0.0731 0.0745 0.0752 0.0758 0.0763 0.0768 0.0771 0.0775 0.0778 0.0781 0.0784 0.0787 0.0792 0.0797 0.0804 0.0813 0.0825 0.084 0.0859 0.0882 0.0909 0.0941 0.1018 0.1103 0.1197 0.1299 0.1409 0.1525 0.1648 0.1777 0.191 0.2049 0.2191 0.2336 0.2484 0.2633 0.2783 0.2932 0.3081 0.3228 0.3373 0.347 0.3565 0.3657 0.3746 0.3833 0.3917 0.3999 0.4078 0.4155 0.423 0.4303 0.4374 0.4443 0.451 0.458 0.4648 0.4715 0.4781 0.4845 0.4909 0.497 0.5031 0.5091 0.5149 0.5206 0.5262 0.5318 0.5372 0.5425 0.5478 0.5529 0.5581 0.5632 0.5682 0.5731 0.578 0.5829 0.5877 0.5925 0.5973 0.602 0.6067 0.6115 0.6162 0.6209 0.6257 0.6305 0.6353 0.6407 0.6462 0.6517 0.6573 0.6628 0.6684 0.6739 0.6795 0.685 0.6906 0.6961 0.7015 0.7069 0.7123 0.7176 0.7221 0.7265 0.7308 0.735 0.739 0.743 0.7469 0.7508 0.7545 0.7582 0.7618 0.7653 0.7688 0.7722 0.7756 0.7789 0.7822 0.7855 0.7887 0.7919 0.7951 0.7983 0.8015 0.8047 0.8078 0.8116 0.8155 0.8193 0.823 0.8268 0.8306 0.8344 0.8381 0.8419 0.8456 0.8493 0.853 0.8567 0.8603 0.8639 0.8675 0.871 0.8745 0.8779 0.8812 0.8845 0.8877 0.8909 0.8941 0.8971 0.9002 0.9032 0.9061 0.909 0.9119 0.9146 0.9174 0.92 0.9226 0.9252 0.9276 0.9301 0.9324 0.9347 0.9369 0.9391 0.9412 0.9429 0.9446 0.9462 0.9478 0.9493 0.9508 0.9522 0.9536 0.9549 0.9562 0.9575 0.9588 0.96 0.9612 0.9624 0.9635 0.9647 0.9659 0.967 0.9682 0.9693 0.9705 0.9717 0.9729 0.9741 0.9753 0.9766 0.9779 0.9793 0.9807 0.9821 0.9836 0.9851 0.9867 0.9884 0.9901 0.9919 0.9938 0.9958 0.9978 1);
		tableGreen: #(0 0 0 0 0 0 0 0 0 0 0.0001 0.0008 0.0017 0.0029 0.0044 0.0061 0.0081 0.0105 0.0132 0.0162 0.0196 0.0233 0.0275 0.0319 0.0367 0.0419 0.0475 0.0534 0.0597 0.0663 0.0733 0.0805 0.0881 0.096 0.1041 0.1125 0.1212 0.13 0.1391 0.1483 0.1576 0.1671 0.1766 0.1862 0.1957 0.2053 0.2147 0.2241 0.2333 0.2422 0.251 0.2571 0.2631 0.2688 0.2744 0.2799 0.2851 0.2902 0.2952 0.3 0.3046 0.3091 0.3134 0.3176 0.3222 0.3266 0.3309 0.3352 0.3394 0.3436 0.3476 0.3516 0.3556 0.3595 0.3633 0.3671 0.3709 0.3746 0.3783 0.382 0.3857 0.3894 0.393 0.3967 0.4004 0.4042 0.4079 0.4118 0.4162 0.4207 0.4251 0.4296 0.4342 0.4387 0.4432 0.4478 0.4523 0.4569 0.4615 0.466 0.4706 0.4748 0.479 0.4832 0.4873 0.4914 0.4954 0.4995 0.5034 0.5074 0.5113 0.5152 0.519 0.5229 0.5267 0.5304 0.5342 0.5379 0.5416 0.5453 0.549 0.5526 0.5563 0.5599 0.5635 0.5671 0.5708 0.5744 0.578 0.5816 0.5852 0.5888 0.5924 0.5961 0.6002 0.6043 0.6084 0.6125 0.6165 0.6205 0.6246 0.6286 0.6325 0.6364 0.6403 0.6442 0.648 0.6518 0.6555 0.6591 0.6627 0.6658 0.6687 0.6716 0.6745 0.6773 0.68 0.6828 0.6854 0.6881 0.6907 0.6934 0.696 0.6986 0.7012 0.7039 0.7066 0.7093 0.712 0.7148 0.7176 0.7219 0.7262 0.7306 0.735 0.7395 0.744 0.7485 0.7531 0.7576 0.7622 0.7667 0.7712 0.7757 0.7801 0.7844 0.7887 0.7928 0.7969 0.8008 0.8046 0.8083 0.8118 0.8137 0.8155 0.8171 0.8186 0.82 0.8213 0.8225 0.8236 0.8246 0.8255 0.8264 0.8272 0.828 0.8287 0.8294 0.83 0.8307 0.8314 0.8332 0.8351 0.837 0.8389 0.8409 0.8429 0.8449 0.847 0.8491 0.8512 0.8533 0.8553 0.8574 0.8595 0.8616 0.8636 0.8656 0.8676 0.8695 0.8714 0.8733 0.875 0.8768 0.8784 0.88 0.8815 0.8829 0.8843 0.8855 0.8866 0.8876 0.8885 0.8893 0.8899 0.8904 0.8908 0.891 0.891 0.8909 0.8906 0.8901 0.8895 0.8886 0.8875 0.8863);
		tableBlue: #(0.2627 0.2628 0.263 0.2632 0.2636 0.2641 0.2647 0.2654 0.2662 0.2672 0.2683 0.2695 0.2708 0.2722 0.2738 0.2754 0.2772 0.2791 0.2811 0.2832 0.2854 0.2878 0.2902 0.2927 0.2953 0.2981 0.3009 0.3038 0.3067 0.3098 0.3129 0.316 0.3192 0.3225 0.3258 0.3292 0.3325 0.3359 0.3393 0.3428 0.3462 0.3496 0.3529 0.3556 0.3582 0.3607 0.3631 0.3655 0.3679 0.3701 0.3723 0.3745 0.3766 0.3787 0.3808 0.3828 0.3847 0.3867 0.3886 0.3905 0.3924 0.3943 0.3962 0.3981 0.4 0.4028 0.4057 0.4086 0.4115 0.4144 0.4174 0.4204 0.4234 0.4264 0.4294 0.4324 0.4354 0.4385 0.4414 0.4444 0.4474 0.4503 0.4532 0.456 0.4588 0.4609 0.4629 0.4649 0.4667 0.4686 0.4703 0.472 0.4737 0.4753 0.4769 0.4784 0.4799 0.4814 0.4828 0.4843 0.4857 0.4871 0.4885 0.4899 0.4913 0.4927 0.4941 0.4963 0.4985 0.5008 0.5031 0.5054 0.5078 0.5102 0.5126 0.5151 0.5176 0.5201 0.5227 0.5252 0.5278 0.5304 0.533 0.5356 0.5383 0.5409 0.5436 0.5462 0.5489 0.5516 0.5542 0.5569 0.5592 0.5616 0.564 0.5663 0.5687 0.571 0.5733 0.5757 0.578 0.5804 0.5827 0.585 0.5874 0.5897 0.5921 0.5944 0.5968 0.5992 0.6015 0.6039 0.6064 0.6088 0.6113 0.6138 0.6162 0.6187 0.6213 0.6238 0.6263 0.6289 0.6314 0.634 0.6366 0.6392 0.6418 0.6444 0.6471 0.65 0.6529 0.6559 0.6588 0.6618 0.6648 0.6678 0.6707 0.6737 0.6767 0.6796 0.6826 0.6855 0.6883 0.6912 0.694 0.6968 0.6995 0.7021 0.7048 0.7073 0.7098 0.7114 0.713 0.7145 0.716 0.7174 0.7187 0.72 0.7212 0.7224 0.7236 0.7247 0.7259 0.727 0.7281 0.7292 0.7303 0.7314 0.7325 0.7336 0.7348 0.736 0.7373 0.7395 0.7418 0.7441 0.7464 0.7488 0.7512 0.7536 0.7561 0.7585 0.7609 0.7634 0.7658 0.7682 0.7706 0.773 0.7753 0.7776 0.7799 0.7821 0.7842 0.7862 0.7882 0.7901 0.792 0.7937 0.7953 0.7968 0.7982 0.7995 0.8006 0.8016 0.8025 0.8032 0.8037 0.8041 0.8043 0.8043 0.8041 0.8037 0.8031 0.8023 0.8013 0.8)
]
